(function(a){a.fn.roto=function(b){var c={btnPrev:".prev",btnNext:".next",direction:"h",shift_duration:200,shift_bezier:[0,0,0,1],drift_duration:1800,drift_factor:500,drift_bezier:[0,.5,.5,1],bounce_duration:350,bounce_bezier:[0,0,.6,1],pull_divisor:3,timer_interval:50,msToS:1e3,disable_transitions:!1};b=a.extend(c,b||{});var d=!1;try{document.createEvent("TouchEvent"),d=!0}catch(e){d=!1}var f=function(a){return d?typeof a.originalEvent.touches!="undefined"?a.originalEvent.touches[0]:a:a},g=null,h=null,i=null;(function(){if(b.disable_transitions)return;var a=document.body||document.documentElement,c={transform:"transform",MozTransform:"-moz-transform",WebkitTransform:"-webkit-transform"},d={transition:{prop:"transition",event:"transitionend"},MozTransition:{prop:"-moz-transition",event:"transitionend"},WebkitTransition:{prop:"-webkit-transition",event:"webkitTransitionEnd"}};for(var e in c)if(typeof a.style[e]!="undefined"){g=c[e];break}for(var e in d)if(typeof a.style[e]!="undefined"){h=d[e].prop,i=d[e].event;break}})();var j=function(c,d,e,f,g){if(h!==null){var j={};j[h+"-duration"]=e/b.msToS+"s",j[h+"-timing-function"]=["cubic-bezier(",b[f+"_bezier"].join(","),")"].join(""),c.css(j),c.one(i,g),c.css(d)}else c.animate(d,e,a.bez(b[f+"_bezier"]),g)};return this.each(function(){var e={h:{measure:"Width",offsetName:"left",coOrd:"X"},v:{measure:"Height",offsetName:"top",coOrd:"Y"}},i=e[b.direction],k=d?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},l=a(this),m=l.find("ul").first(),n=m.find("li"),o=0,p=0,q=0,r=p,s=0,t=0,u=typeof l.attr("id")!==undefined?l.attr("id"):(new Date).getTime()+"",v=!1,w=l.find(b.btnPrev),x=l.find(b.btnNext);l.css({overflow:"hidden",position:"relative"}),m.css({position:"relative",whiteSpace:"nowrap",padding:0,margin:0}),n.css({display:"block","float":"left",listStyle:"none"});var y=function(){if(h!==null){var a={},c=g!==null?g:i.offsetName;a[h]=c+" "+b.shift_duration/b.msToS+"s ease 0s",m.css(a)}},z=function(){if(h!==null){var a={};a[h]="none",m.css(a)}},A=function(a){if(h!==null){var b=D();z(),m.css(C(b))}else a.stop()};y(),h==="-webkit-transition"&&m.css("-webkit-backface-visibility","hidden"),w.length===0&&b.btnPrev===c.btnPrev&&l.attr("id")&&(w=a("#"+l.attr("id")+"-prev"),x=a("#"+l.attr("id")+"-next"));var B=function(){s=Math.ceil(m.parent()[i.measure.toLowerCase()]()),q=Math.ceil(t-s+o)*-1},C=function(a){var b={};if(g!==null){var c=d?"3d":"",e=c==="3d"?"(Xpx,Ypx,0px)":"(Xpx,Ypx)",f={X:"Y",Y:"X"};b[g]="translate"+c+e.replace(i.coOrd,a).replace(f[i.coOrd],"0")}else b[i.offsetName]=a+"px";return b},D=function(){var a=m.position()[i.offsetName]-o;if(g===null)return a;var b=m.css(g),c=b.match(/\-?[0-9]+/g);if(c===null)return a;var d=i.coOrd==="X"?c[4]:c[5];return parseInt(d)},E=function(){t>s-r?x.removeAttr("disabled"):x.attr("disabled","disabled"),r+o<p?w.removeAttr("disabled"):w.attr("disabled","disabled")},F=function(c){if(v)return;v=!0,y();var d=function(a){j(m,C(a),b.shift_duration,"shift",function(){r=a,E(),v=!1})},e=function(b){var c=0,d=n.get(0);return a.each(n,function(e,f){c=-1*Math.ceil(a(f).position()[i.offsetName]);if(c<b)return!1;d=f}),d};switch(c){case"prev":var f=e(r+s);break;case"next":var f=e(r-s)}var g=Math.ceil(a(f).position()[i.offsetName]),h=-1*(s-(s-g));d(h)},G=function(a){var c=Math.ceil(a+r);c<p+s/b.pull_divisor&&c>q-s/b.pull_divisor&&m.css(C(c))},H=function(){var a=J.getPointerSpeed(),c=a[0],d=a[1];if(c===0)return;var e=c*b.drift_factor*d,f=e+r;f>p&&(f=p),f<q&&(f=q),j(m,C(f),b.drift_duration,"drift",function(){r=D()-o,r>p&&I(!1),E()})},I=function(a){var c=a?q:p;j(m,C(c),b.bounce_duration,"bounce",function(){r=c-o,E()})},J=function(){var a=0,c=0,d=null,e={startCoOrd:0,endCoOrd:0};return{start:function(){a=c,d=window.setInterval(function(){e.startCoOrd=a,e.endCoOrd=c,a=c},b.timer_interval)},stop:function(){clearInterval(d),e.endCoOrd=c},getPointerSpeed:function(){var a=e.endCoOrd-e.startCoOrd,c=Math.abs(a),d=c/b.timer_interval,f=a<0?-1:1;return[d,f]},setCurrentCoOrd:function(a){c=a}}}();a(window).resize(function(){s=m.parent()[i.measure.toLowerCase()](),B(),E()}),m.bind(k.start+".roto."+u,function(b){A(m),E();var c=m.find("a"),e={};d||(b.preventDefault(),document.ondragstart!==undefined&&m.find("a, img").one("dragstart",function(a){a.preventDefault()}),c.length>0&&a(document).one(k.move+".roto."+u,function(b){c.one("click.roto."+u,function(a){a.preventDefault()}),a.each(c.data("events"),function(b,c){e[b]=[],a.each(c,function(a,c){e[b].push(c)})}),c.unbind(),c.bind("click.roto."+u,function(a){a.preventDefault()})})),b=f(b);var g=b["screen"+i.coOrd];r=D()-o,J.setCurrentCoOrd(g),a(document).bind(k.move+".roto."+u,function(a){a.preventDefault(),a=f(a),J.setCurrentCoOrd(a["screen"+i.coOrd]),G(a["screen"+i.coOrd]-g)}),a(document).one(k.end,function(){J.stop(),y(),r=D(),r>p||r<q?I(r<q):H(),a(document).unbind(k.move+".roto."+u),!d&&c.length>0&&window.setTimeout(function(){c.unbind("click.roto."+u),a.each(e,function(b,d){a.each(d,function(a,b){c.bind(b.type+"."+b.namespace,b.data,b.handler)})})},250)}),J.start()}),b.btnPrev&&w.click(function(){return F("prev")}),b.btnNext&&x.click(function(){return F("next")});if(b.direction==="h")n.each(function(b,c){t+=Math.ceil(a(c)["outer"+i.measure](!0))}),m[i.measure.toLowerCase()](t+Math.ceil(t/100));else{var K=n.last();t=Math.round(a(K).position()[i.offsetName]+a(K)["outer"+i.measure](!0))}if(t<=s){b.btnPrev&&w.hide(),b.btnNext&&x.hide();return}o=Math.ceil(D()),B(),E()})}})(jQuery)